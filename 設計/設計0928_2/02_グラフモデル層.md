# 02_グラフモデル層

ノード・VM・エッジVM系クラスと、座標変換システム、「〜と見なせる」ラップクラスを定義します。

```mermaid
classDiagram
    direction RL
    %% ========== インターフェース定義 ==========
    class IノードVM標準描画座標と見なせる {
        <<interface>>
        +ノードVM標準(): ノードVM標準描画座標
    }
    
    class IエッジVM標準描画座標と見なせる {
        <<interface>>
        +エッジVM標準(): エッジVM標準描画座標
    }
    
    class IノードVM標準画面座標と見なせる {
        <<interface>>
        +ノードVM標準(): ノードVM標準画面座標
    }
    
    class IノードVM標準図形内座標と見なせる {
        <<interface>>
        +ノードVM標準(): ノードVM標準図形内座標
    }
    
    %% ========== ノードVM実装クラス群 ==========
    class ノードVM標準描画座標 {
        +位置: 描画座標点
        +サイズ: サイズ
        +id: ノードID
        +constructor(位置: 描画座標点, サイズ: サイズ, id: ノードID)
        +ノードVM標準(): ノードVM標準描画座標
        +to画面座標(): ノードVM標準画面座標
        +to図形内座標(基準: 図形内基準座標): ノードVM標準図形内座標
    }
    
    class ノードVM標準画面座標 {
        +位置: 画面座標点
        +サイズ: サイズ
        +id: ノードID
        +constructor(位置: 画面座標点, サイズ: サイズ, id: ノードID)
        +ノードVM標準(): ノードVM標準画面座標
        +to描画座標(基準: 描画基準座標): ノードVM標準描画座標
        +to図形内座標(基準: 図形内基準座標): ノードVM標準図形内座標
    }
    
    class ノードVM標準図形内座標 {
        +位置: 図形内座標点
        +サイズ: サイズ
        +id: ノードID
        +constructor(位置: 図形内座標点, サイズ: サイズ, id: ノードID)
        +ノードVM標準(): ノードVM標準図形内座標
        +to描画座標(): ノードVM標準描画座標
        +to画面座標(): ノードVM標準画面座標
        +to別の図形内座標(新しい図形内座標: 図形内基準座標): ノードVM標準図形内座標
    }
    
    %% ========== エッジVM実装クラス群 ==========
    class エッジVM標準描画座標 {
        +start: ノードVM標準描画座標
        +end: ノードVM標準描画座標
        +id: エッジID
        +constructor(start: ノードVM標準描画座標, end: ノードVM標準描画座標, id: エッジID)
        +エッジVM標準(): エッジVM標準描画座標
    }
    
    %% ========== ラップクラス群（〜と見なせるシリーズ） ==========
    class ノードVM標準描画座標と見なせるT {
        -_ノードVM標準: ノードVM標準描画座標
        +vm: T
        +constructor(ノードVM標準: ノードVM標準描画座標, vm: T)
        +ノードVM標準(): ノードVM標準描画座標
    }
    
    class エッジVM標準描画座標と見なせるT {
        -_エッジVM標準: エッジVM標準描画座標
        +vm: T
        +constructor(エッジVM標準: エッジVM標準描画座標, vm: T)
        +エッジVM標準(): エッジVM標準描画座標
    }
    
    class ノードVM標準画面座標と見なせるT {
        -_ノードVM標準: ノードVM標準画面座標
        +vm: T
        +constructor(ノードVM標準: ノードVM標準画面座標, vm: T)
        +ノードVM標準(): ノードVM標準画面座標
    }
    
    class ノードVM標準図形内座標と見なせるT {
        -_ノードVM標準: ノードVM標準図形内座標
        +vm: T
        +constructor(ノードVM標準: ノードVM標準図形内座標, vm: T)
        +ノードVM標準(): ノードVM標準図形内座標
    }
    
    %% ========== グラフ集約クラス ==========
    class グラフVM標準描画座標 {
        +ノード: IノードVM標準描画座標と見なせる[]
        +エッジ: IエッジVM標準描画座標と見なせる[]
        +constructor(ノード?: IノードVM標準描画座標と見なせる[], エッジ?: IエッジVM標準描画座標と見なせる[])
    }
    
    class IグラフVM標準描画座標を持つ {
        <<interface>>
        +グラフVM標準描画座標(): グラフVM標準描画座標
    }
    
    %% ========== ファクトリー ==========
    class ノードVMFactory {
        <<namespace>>
        +create描画座標(位置: 描画座標点, サイズ: サイズ): ノードVM標準描画座標
        +create画面座標(位置: 画面座標点, サイズ: サイズ): ノードVM標準画面座標
        +create図形内座標(位置: 図形内座標点, サイズ: サイズ): ノードVM標準図形内座標
    }
    
    class エッジVMFactory {
        <<namespace>>
        +create描画座標(start: ノードVM標準描画座標, end: ノードVM標準描画座標): エッジVM標準描画座標
    }
    
    %% ========== 関係性 ==========
    ノードVM標準描画座標 ..|> IノードVM標準描画座標と見なせる : 実装
    ノードVM標準画面座標 ..|> IノードVM標準画面座標と見なせる : 実装
    ノードVM標準図形内座標 ..|> IノードVM標準図形内座標と見なせる : 実装
    エッジVM標準描画座標 ..|> IエッジVM標準描画座標と見なせる : 実装
    
    ノードVM標準描画座標と見なせるT ..|> IノードVM標準描画座標と見なせる : 実装
    エッジVM標準描画座標と見なせるT ..|> IエッジVM標準描画座標と見なせる : 実装
    ノードVM標準画面座標と見なせるT ..|> IノードVM標準画面座標と見なせる : 実装
    ノードVM標準図形内座標と見なせるT ..|> IノードVM標準図形内座標と見なせる : 実装
    
    グラフVM標準描画座標 "*" --> "*" IノードVM標準描画座標と見なせる : 持つ
    グラフVM標準描画座標 "*" --> "*" IエッジVM標準描画座標と見なせる : 持つ
    
    ノードVM標準描画座標と見なせるT "1" --> "1" ノードVM標準描画座標 : ラップ
    エッジVM標準描画座標と見なせるT "1" --> "1" エッジVM標準描画座標 : ラップ
    
    ノードVM標準描画座標 "1" --> "1" 描画座標点 : 位置
    ノードVM標準描画座標 "1" --> "1" サイズ : サイズ
    ノードVM標準描画座標 "1" --> "1" ノードID : id
```

## 説明

### 座標系変換システム
- 3つの座標系（描画・画面・図形内）を相互変換
- 型安全性を確保し、間違った座標系の混同を防止

### 「〜と見なせる」ラップクラス
- ノードVM情報と配置物固有の情報を組み合わせ
- ジェネリクスでタイプセーフな組み合わせを実現
- Adapterパターンの実装

### グラフ集約クラス
- ノードとエッジのコレクションを管理
- 一つの座標系で统一されたグラフを表現

### ファクトリー関数
- 型安全なオブジェクト作成をサポート
- IDの自動生成で作成を簡単化

---
[← README に戻る](./README.md)